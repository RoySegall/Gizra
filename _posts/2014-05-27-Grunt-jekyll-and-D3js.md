---
title: "Grunt, jekyll and D3.js - Together!!!"
tags: 
  - grunt
  - jekyll
  - d3js
  - data visualization
permalink: "/content/grunt-jekyll-and-d3js"
layout: post
published: true
---

At the Beginning of 2014, we worked in a interesting project, to create an mobile web site for an exposition in two different languages for a museum in madrid [Casa del Lector](http://www.gizra.com/content/casa-del-lector/).

Developed a [site](http://gizra.github.io/CDL/) was absorbing, this begun looking components and best practices to achieve the architecture of an Autogenerated Site Backendless.

Sound fancy, ;) but it's just a short way to explain, how some great tools of the Web Platform of today ([gruntjs](http://gruntjs.com/), [jekyll](http://jekyllrb.com/d3) abd [D3](http://d3js.org/)), help us to build amazing sites.

<!-- more -->

---

during this process we achieve some experiece that could be useful if you developing something similar.

# Backendless, How convert the XML data in node system navigation?

All the data comming from a imported XML (without any XML schema), generated by a 3rd. party desktop application used by the museum.

So, we had to analize, transform and prepare the data will be used by d3js and the jekyll templates.

for this was created 3 [custom task](http://gruntjs.com/creating-tasks) with grunt, because the data could be change many time in a day.

to put all together in an [automated process](https://github.com/Gizra/CDL/blob/master/Gruntfile.js) where we put the XML files in the project folder and then write in the command line:

```bash
grunt serve
```
check locally if everything was fine, and then with;

```bash
grunt build
```

prepare data, generate pages and finally publish the site [github pages](https://pages.github.com/)

to accomplish this we use some great [grunt plugins](http://gruntjs.com/plugins) like [grunt-text-replace](https://github.com/yoniholmes/grunt-text-replace), [he](https://github.com/mathiasbynens/he) HTML encoder/decoder, [underscore](https://github.com/jashkenas/underscore), [grunt-convert](https://github.com/assemble/grunt-convert) and [grunt-gh-pages](https://github.com/tschaub/grunt-gh-pages).

# How autogenerated the pages?

We start to write the [jekyll templates](http://jekyllrb.com/docs/templates/), once the data was ready in json files. this process not was very lineal. we found issues of encoding and complex nested view.

so we back to the custom task in grunt, to fix the encoding of the files, prepare the data in the wy that the jekyll template will be easy enough.

[jekyll + yeoman](https://github.com/robwierzbowski/generator-jekyllrb) it's mighty team!


# Node map, D3js visualization

We select some [examples](https://github.com/mbostock/d3/wiki/Gallery) that help us to build, just practice to know how to worked with the d3js, this is similar to jquery about DOM manipulation.

however the mobile performance could improve, was necessary to rethink beyond the examples and the API recommendation.

If you work in a mobile application with d3js it's crucial use tools like [chrome devtools timeline](https://developer.chrome.com/devtools/docs/timeline) to keep for example the animations and interactions below 60fps.

In an general way, the most problematics issues in performance are related handle events and animations.


# Mobile Target, How to achieve the good performance?

Oh!, wait visitor will use iPad or a mobiles phone. So, performance really matters!

Beside a responsive design of the templates, we follow good practice for mobile sites and application target, a fluid navigation and a good response in the touch events was our needs.

Bottom line we remove the [300ms](http://updates.html5rocks.com/2013/12/300ms-tap-delay-gone-away) by double-tap zoom, we tke care about the target size in the node map as [Tim Park](https://www.youtube.com/watch?v=vzOy_ldZNXQ&feature=youtu.be&t=2m18s) recommend in his talk.

And finally we add son [debounce](http://drupalmotion.com/article/debounce-and-throttle-visual-explanation) to deal with the multiple events trigger in the zoom event of d3js, according the devices like touch, mouseover, mouseout, and and we add



