---
title: "Super fast layered maps with Topojson"
tags:
  - AngularJs
  - Leaflet-map
  - topojson
  - geojson
permalink: "/content/topojson"
layout: post
author: NaderSafadi
published: true
---

{% include setup %}

To have an interactive map on your website have never been easier with [AngularJs](https://angularjs.org/) and [Leaflet](http://leafletjs.com/), 
A map with layers to show you the information upon hovering, clicking, etc..  on a city, province, country, any kind of information you want.
 
<!-- more -->

So while we were creating this kind of a map for a client, We used [angular-leaflet-directive](https://github.com/tombatossals/angular-leaflet-directive)
, We got a huge Geojson from the client and with the help of AngularJs and this directive we were able to divide the map into provinces and display lots of information on each province.
 
<div class="thumbnail">
  <img src="{{BASE_PATH}}/assets/images/posts/topojson/ibli1.png">
  <div class="caption">A map divided by provinces. With GeoJson</div>
</div>


But like i said, the Geojson was huge, very slow to load from the server, it took exactly (1.47â€‰seconds - on localhost) Which is a life-time,
So what we did is that we converted that to Topojson which way much lighter and gave it to the map, The only problem is that the map doesn't know how to read topojson.
I searched and searched the mighty internet but never got a clear answer, and when i found it, it was really really easy.

So i thought i would share it with you guys:

First, Bower install or download and include this library [TopoJSON](https://github.com/mbostock/topojson/)

Second, fetch the data from the file in an $http AngularJs method or any ajax method if you are using any other library.

We use angularJs, so it looks like this:

```js
$http({
  method: 'GET',
  url: 'sites/default/files/data/KenyaEthiopia_IBLIunits_July2014.topojson',
  serverPredefined: true
})
```

Finally, on your success promise all you have to do is call "topojson.feature" on the 'data' object you get back.

Like this:

```js
var GeoJsonObject = {
  data: topojson.feature(data, data.objects.unites)
};
```


You now have your GeoJson object which the leaflet map will know how to read.

What's the loading time for the TopoJson you ask ?
Well see for your self.

1) Remote server:
<div class="thumbnail">
  <img src="{{BASE_PATH}}/assets/images/posts/topojson/remote_server.png">
  <div class="caption">It takes 641 milliseconds</div>
</div>

2) Localhost:
<div class="thumbnail">
  <img src="{{BASE_PATH}}/assets/images/posts/topojson/localhost.png">
  <div class="caption">You gotta be kidding me, 14 milliseconds, 14!!, Remember it was 1.47 seconds with GeoJson</div>
</div>

That's it, Advised to get your map data with TopoJson, it's much faster and not difficult to implement.


